<pre style="color: rgb(0, 0, 0); background: rgb(255, 255, 255) none repeat scroll 0% 0%; --darkreader-inline-color:#e8e6e3; --darkreader-inline-bgcolor:#181a1b; --darkreader-inline-bgimage:none;" data-darkreader-inline-color="" data-darkreader-inline-bgcolor="" data-darkreader-inline-bgimage=""><span style="color: rgb(128, 0, 0); font-weight: bold; --darkreader-inline-color:#ff7272;" data-darkreader-inline-color="">import</span> serial
<span style="color: rgb(128, 0, 0); font-weight: bold; --darkreader-inline-color:#ff7272;" data-darkreader-inline-color="">from</span> easymodbus <span style="color: rgb(128, 0, 0); font-weight: bold; --darkreader-inline-color:#ff7272;" data-darkreader-inline-color="">import</span> modbusClient

COMPORT <span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">=</span> <span style="color: rgb(0, 0, 230); --darkreader-inline-color:#4287ff;" data-darkreader-inline-color="">'COM7'</span>

ser <span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">=</span> serial<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">.</span>Serial<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">(</span>COMPORT<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">,</span> <span style="color: rgb(0, 140, 0); --darkreader-inline-color:#6aff6a;" data-darkreader-inline-color="">9600</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">,</span> <span style="color: rgb(0, 140, 0); --darkreader-inline-color:#6aff6a;" data-darkreader-inline-color="">8</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">,</span> stopbits<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">=</span><span style="color: rgb(0, 140, 0); --darkreader-inline-color:#6aff6a;" data-darkreader-inline-color="">2</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">,</span> timeout<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">=</span><span style="color: rgb(0, 140, 0); --darkreader-inline-color:#6aff6a;" data-darkreader-inline-color="">1</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">)</span>
ser<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">.</span>close<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">(</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">)</span>

modbus_efuse <span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">=</span> modbusClient<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">.</span>ModbusClient<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">(</span>COMPORT<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">)</span>
modbus_efuse<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">.</span>connect<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">(</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">)</span>

<span style="color: rgb(128, 0, 0); font-weight: bold; --darkreader-inline-color:#ff7272;" data-darkreader-inline-color="">class</span> Test_Modbus<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">:</span>
    <span style="color: rgb(128, 0, 0); font-weight: bold; --darkreader-inline-color:#ff7272;" data-darkreader-inline-color="">def</span> test_write_read_1coil<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">(</span>self<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">)</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">:</span>
        modbus_efuse<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">.</span>write_single_coil<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">(</span><span style="color: rgb(0, 140, 0); --darkreader-inline-color:#6aff6a;" data-darkreader-inline-color="">1</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">,</span> <span style="color: rgb(7, 71, 38); --darkreader-inline-color:#cfcbc5;" data-darkreader-inline-color="">True</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">)</span>
        coils <span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">=</span> modbus_efuse<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">.</span>read_coils<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">(</span><span style="color: rgb(0, 140, 0); --darkreader-inline-color:#6aff6a;" data-darkreader-inline-color="">1</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">,</span> <span style="color: rgb(0, 140, 0); --darkreader-inline-color:#6aff6a;" data-darkreader-inline-color="">1</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">)</span>
        <span style="color: rgb(128, 0, 0); font-weight: bold; --darkreader-inline-color:#ff7272;" data-darkreader-inline-color="">assert</span> coils<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">[</span><span style="color: rgb(0, 140, 0); --darkreader-inline-color:#6aff6a;" data-darkreader-inline-color="">0</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">]</span> <span style="color: rgb(68, 170, 221); --darkreader-inline-color:#51b0df;" data-darkreader-inline-color="">==</span> <span style="color: rgb(7, 71, 38); --darkreader-inline-color:#cfcbc5;" data-darkreader-inline-color="">True</span>
    <span style="color: rgb(128, 0, 0); font-weight: bold; --darkreader-inline-color:#ff7272;" data-darkreader-inline-color="">def</span> test_write_read_multiple<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">(</span>self<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">)</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">:</span>
        modbus_efuse<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">.</span>write_multiple_coils<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">(</span><span style="color: rgb(0, 140, 0); --darkreader-inline-color:#6aff6a;" data-darkreader-inline-color="">0</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">,</span> <span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">[</span><span style="color: rgb(7, 71, 38); --darkreader-inline-color:#cfcbc5;" data-darkreader-inline-color="">True</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">,</span> <span style="color: rgb(7, 71, 38); --darkreader-inline-color:#cfcbc5;" data-darkreader-inline-color="">True</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">]</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">)</span>
        coils <span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">=</span> modbus_efuse<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">.</span>read_coils<span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">(</span><span style="color: rgb(0, 140, 0); --darkreader-inline-color:#6aff6a;" data-darkreader-inline-color="">0</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">,</span> <span style="color: rgb(0, 140, 0); --darkreader-inline-color:#6aff6a;" data-darkreader-inline-color="">2</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">)</span>
        <span style="color: rgb(128, 0, 0); font-weight: bold; --darkreader-inline-color:#ff7272;" data-darkreader-inline-color="">assert</span> coils <span style="color: rgb(68, 170, 221); --darkreader-inline-color:#51b0df;" data-darkreader-inline-color="">==</span> <span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">[</span><span style="color: rgb(7, 71, 38); --darkreader-inline-color:#cfcbc5;" data-darkreader-inline-color="">True</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">,</span><span style="color: rgb(7, 71, 38); --darkreader-inline-color:#cfcbc5;" data-darkreader-inline-color="">True</span><span style="color: rgb(128, 128, 48); --darkreader-inline-color:#cfcf80;" data-darkreader-inline-color="">]</span>
</pre>
